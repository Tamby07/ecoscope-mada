<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  var map = L.map('map').setView([-18.8792, 47.5079], 6);

  var baseLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Données © OpenStreetMap',
    maxZoom: 18
  }).addTo(map);

  // Couches raster
  var occupationSol = L.imageOverlay('AA_OS.png', [[-25.2899, 43.1768], [-20.9083, 45.7948]]);
  var agbd = L.imageOverlay('data/agbd.png', [[-24.2297, 43.2688], [-22.3325, 44.3464]]);
  var rainfall = L.imageOverlay('Rainfall.png', [[-25.2899, 43.1768], [-20.9083, 45.7948]]);

  // Groupe de couches
  var overlays = {
    "Land Use Land Cover": occupationSol,
    "AGBD (biomasse)": agbd,
    "Rainfall": rainfall
  };

  L.control.layers(null, overlays, { collapsed: false }).addTo(map);

  // Ajouter couche LULC par défaut
  occupationSol.addTo(map);
  document.querySelector('.legend').style.display = 'block';

  // ✅ Détecter l'ajout d'une couche
  map.on('overlayadd', function (e) {
    if (e.layer === occupationSol) {
      document.querySelector('.legend').style.display = 'block';
    }
  });

  // ✅ Détecter la suppression d'une couche
  map.on('overlayremove', function (e) {
    if (e.layer === occupationSol) {
      document.querySelector('.legend').style.display = 'none';
    }
  });
</script>
